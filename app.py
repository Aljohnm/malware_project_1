import pandas as pd
from fastapi import FastAPI
from fastapi.responses import HTMLResponse
import json

app = FastAPI()

# Load the trained dataset globally so it can be accessed in any function
trained_summary = None

@app.on_event("startup")
async def startup_event():
    global trained_summary
    # Load your CSV or DataFrame here
    trained_summary = pd.read_csv('malware_train_data.csv')  # Update the path accordingly

@app.get("/")
async def root():
    return HTMLResponse(content=open("templates/index.html").read())

@app.get("/trained_dataset_summary/")
async def trained_dataset_summary():
    # Check if trained_summary is loaded
    if trained_summary is None:
        return HTMLResponse(content="Trained summary is not available.", status_code=500)

    # Convert the DataFrame to a dictionary or any format you need
    summary = trained_summary.describe().to_json()  # Get summary statistics as JSON
    return HTMLResponse(content=summary)

